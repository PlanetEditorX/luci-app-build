<%+header%>
<h2><%:运行状态%></h2>
<div id="status-container">
    <p><%:加载中...%></p>
</div>

<script type="text/javascript">
function loadStatus() {
    fetch('/cgi-bin/luci/admin/services/keepalived-ha/api_status')
        .then(response => response.json())
        .then(data => {
            const status = `
                <p><%:Keepalived服务状态%>: ${data.running ? '<span style="color:green"><%:运行中%></span>' : '<span style="color:red"><%:已停止%></span>'}</p>
                <p><%:Watchdog服务状态%>: ${data.watchdog ? '<span style="color:green"><%:运行中%></span>' : '<span style="color:red"><%:已停止%></span>'}</p>
            `;
            document.getElementById('status-container').innerHTML = status;
        })
        .catch(error => {
            document.getElementById('status-container').innerHTML = `<p style="color:red"><%:获取状态失败%>: ${error}</p>`;
        });
}

// 页面加载时获取一次状态，之后每5秒刷新
loadStatus();
setInterval(loadStatus, 5000);
</script>
<%+footer%>